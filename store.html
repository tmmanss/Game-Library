<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Store - Nitro 5 Gaming Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/store.css" />
  </head>

  <body class="grid-layout">
    <header class="grid-header">
      <div class="logo">
        <a href="index.html">
          <img
            src="images/game_512.png"
            alt="icon"
            width="64"
            class="circular-logo"
          />
        </a>
      </div>

      <!-- –ë—É—Ä–≥–µ—Ä -->
      <button class="burger" id="burger" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <nav id="navbar">
        <ul>
          <li><a href="index.html" data-i18n="nav.home">Home</a></li>
          <li><a href="store.html" class="active" data-i18n="nav.store">Store</a></li>
          <li><a href="about.html" data-i18n="nav.about">About</a></li>
          <li><a href="library.html" data-i18n="nav.library">My Library</a></li>
          <li><a href="gallery.html" data-i18n="nav.gallery">Gallery</a></li>
          <li><a href="reviews.html" data-i18n="nav.reviews">Reviews</a></li>
          <li><a href="ratings.html" data-i18n="nav.ratings">Ratings</a></li>
          <li><a href="platform.html" data-i18n="nav.platform">Platform</a></li>
        </ul>

        <div class="nav-actions">
          <div class="lang-select">
            <label for="langSelect" class="form-label" style="margin:0;">
              <span data-i18n="ui.language">Language:</span>
            </label>
            <select id="langSelect" class="form-select form-select-sm" style="width:auto;">
              <option value="en">English</option>
              <option value="ru">–†—É—Å—Å–∫–∏–π</option>
              <option value="kk">“ö–∞–∑–∞“õ—à–∞</option>
            </select>
          </div>
          <button id="themeToggle" class="btn-mini" type="button" title="Toggle theme">üåô</button>
          <button id="openPopup" class="btn-mini sign-in-btn" type="button" title="Sign in" data-i18n="ui.signin">Sign in</button>
        </div>
      </nav>
    </header>

    <main class="grid-main">
      <section id="store-section" class="store">
        <h2>Game Store</h2>

        <!-- üîç Search Bar -->
        <div id="searchSection" class="content-section">
          <input
            type="text"
            id="searchInput"
            placeholder="Search for a game..."
            class="search-box"
          />
        </div>

        <!-- üéÆ Game Grid -->
        <div class="game-grid" id="gameList">
          <p style="text-align:center;">Loading games...</p>
        </div>
      </section>

      <section id="lazy-section" class="coming">
        <h2>More Games Coming Soon...</h2>
        <div class="lazy-grid">
          <figure class="lazy-card">
            <img class="lazy" data-src="images/mk1.jpg" alt="Mortal Kombat 1">
          </figure>
          <figure class="lazy-card">
            <img class="lazy" data-src="images/wwz.jpg" alt="World War Z">
          </figure>
          <figure class="lazy-card">
            <img class="lazy" data-src="images/thelast.jpg" alt="The Last of Us">
          </figure>
        </div>
      </section>
    </main>

    <footer class="grid-footer">
      <p>&copy; 2024 Nitro 5 Gaming Platform</p>
      <p>Group: SE-2409 | Mansur Tasbolat & Eraly Zalel</p>
      <p id="currentTime" class="footer-time"></p>
    </footer>

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="js/jquery_app.js" defer></script>
    <script src="js/app.js" defer></script>
    <script src="js/theme.js"></script>
    <script src="js/auth.js" defer></script>
    <script src="js/user-actions.js" defer></script>
    <script src="js/auth-modal.js" defer></script>
    <script src="js/ratings.js" defer></script>
    <script src="js/search.js" defer></script>
    <script src="js/api.js" defer></script>
    <script src="js/i18n.js" defer></script>
    <script src="js/enhancements.js" defer></script>

    <script>
      async function loadTrendingGames() {
        const gameList = document.getElementById('gameList');
        const result = await getTrendingGamesAPI(12);
        gameList.innerHTML = '';

        if (result.success && result.games.length > 0) {
          result.games.forEach(game => displayAPIGameCard(game, gameList));
        } else {
          gameList.innerHTML = '<p style="text-align:center;color:red;">Failed to load games from API.</p>';
        }
      }

      async function searchGames(query) {
        const gameList = document.getElementById('gameList');
        if (!query.trim()) return loadTrendingGames();

        gameList.innerHTML = '<p style="text-align:center;">Searching...</p>';
        const result = await searchGamesAPI(query, 1, 12);

        gameList.innerHTML = '';
        if (result.success && result.games.length > 0) {
          result.games.forEach(game => displayAPIGameCard(game, gameList));
        } else {
          gameList.innerHTML = '<p style="text-align:center;color:gray;">No results found.</p>';
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        loadTrendingGames();

        const searchInput = document.getElementById('searchInput');
        let timeout;
        searchInput.addEventListener('input', e => {
          clearTimeout(timeout);
          timeout = setTimeout(() => searchGames(e.target.value), 500);
        });
      });

      // Footer time
      function updateFooterTime() {
        const timeEl = document.getElementById('currentTime');
        if (timeEl) {
          const now = new Date();
          timeEl.textContent = now.toLocaleString('en-US', { 
            month: 'short', day: '2-digit', year: 'numeric',
            hour: '2-digit', minute: '2-digit', second: '2-digit' 
          });
        }
      }
      updateFooterTime();
      setInterval(updateFooterTime, 1000);
    </script>
  </body>
</html>
